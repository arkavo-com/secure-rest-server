syntax = "proto3";

option go_package = "security";

// A system account to allow access for a subject
message Account {
    // unique name
    string name = 1;
    // `json:"-"`
    string salt = 2;
    // `json:"-"`
    string hash = 3;
    State state = 4;
    // []role.proto:Role.name
    repeated string roles = 5;
    enum State {
        nonstate = 0; // not used
        // Account_CREATE,Account_INITIALIZE
        Initialized = 1;
        // Account_ACTIVATE,Account_UPDATE_PASSWORD
        Activated = 2;
        // Account_LOCK
        Locked = 3;
        // Account_DEACTIVATE
        Deactivated = 4;
    }
    enum Action {
        CREATE = 0;
        READ = 1;
        UPDATE = 2;
        UPDATE_PASSWORD = 3;
        ACTIVATE = 4;
        DEACTIVATE = 5;
        LOCK = 6;
        INITIALIZE = 7;
    }
}